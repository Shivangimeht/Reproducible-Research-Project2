---
title: "NOAA Storm Database"
author: "Shivangi"
date: "9/5/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{NOAA Storm Database}
```

    knitr::opts_chunk$set(echo = TRUE)

    library(data.table)
library(ggplot2)

## downloading the file
download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2", "stormdata.csv.bz2")

## reading in the data
data <- read.csv(bzfile("stormdata.csv.bz2"))

## adding up injuries, fatalities, property damagea and crop damage according to event types
aggregatedInjuriesDT <- aggregate(INJURIES~EVTYPE, data, sum)
aggregatedFatalitiesDT <- aggregate(FATALITIES~EVTYPE, data, sum)
aggregatedPropDmgDT <- aggregate(PROPDMG~EVTYPE, data, sum)
aggregatedCropDmgDT <- aggregate(CROPDMG~EVTYPE, data, sum)

## sorting aggregated data sets
sortedInjuriesDT <- aggregatedInjuriesDT[order(aggregatedInjuriesDT$INJURIES , aggregatedInjuriesDT$EVTYPE, decreasing = TRUE), ]
sortedFatalitiesDT <- aggregatedFatalitiesDT[order(aggregatedFatalitiesDT$FATALITIES , aggregatedFatalitiesDT$EVTYPE, decreasing = TRUE), ]
sortedPropDmgDT <- aggregatedPropDmgDT[order(aggregatedPropDmgDT$PROPDMG , aggregatedPropDmgDT$EVTYPE, decreasing = TRUE), ]
sortedCropDmgDT <- aggregatedCropDmgDT[order(aggregatedCropDmgDT$CROPDMG , aggregatedCropDmgDT$EVTYPE, decreasing = TRUE), ]

## grabbing most harmful events, i decided to just take the top 10
mostHarmfulInjuriesEvents <- head(sortedInjuriesDT, n = 10)
mostHarmfulFatalitiesEvents <- head(sortedFatalitiesDT, n = 10)
mostHarmfulPropDmgEvents <- head(sortedPropDmgDT, n = 10)
mostHarmfulCropDmgEvents <- head(sortedCropDmgDT, n = 10)

library(gridExtra)

## plotting injuries, fatalities, property damage and crop damage related events on a graph

p1 <- qplot(INJURIES, EVTYPE, data = mostHarmfulInjuriesEvents , xlab="Number of Injuries", ylab="Event Type")
p2 <- qplot(FATALITIES, EVTYPE, data = mostHarmfulFatalitiesEvents , xlab="Number of Fatalities", ylab="Event Type")
p3 <- qplot(PROPDMG, EVTYPE, data = mostHarmfulPropDmgEvents, xlab="Property Damage", ylab="Event Type")
p4 <- qplot(CROPDMG, EVTYPE, data = mostHarmfulCropDmgEvents, xlab="crop Damage", ylab="Event Type")

grid.arrange(p1, p2, p3, p4, ncol = 2, nrow = 2)

